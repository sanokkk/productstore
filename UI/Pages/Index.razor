@page "/"
@using Blazored.LocalStorage
@using global::UI.Providers
@inject NavigationManager _manager;
@inject ILocalStorageService _localStorage;
@inject AuthenticationStateProvider _authenticationState;

<PageTitle>Index</PageTitle>

<h1>Hello, world!</h1>

Welcome to your new app.

<SurveyPrompt Title="How is Blazor working for you?"/>

<button @onclick="redirect">All is ok</button>

<button @onclick="reg">Rigister</button>

<button @onclick="Logout">Logout</button>

<button @onclick="fetching">Fetching</button>

@code {

    private void redirect()
    {
        _manager.NavigateTo("/fetchpage");
    }

    private void reg()
    {
        _manager.NavigateTo("/Register");
    }

    private void fetching()
    {
        _manager.NavigateTo("/fetchPage");
    }

    private async void Logout()
    {
        await _localStorage.RemoveItemAsync("jwt-token");
        (_authenticationState as AuthProvider).NotifyAuthState();
        _manager.NavigateTo("/login");
    }

}